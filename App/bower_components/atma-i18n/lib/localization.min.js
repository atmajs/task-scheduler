!function(n,t){"use strict";var e,r;"undefined"==typeof exports||n!==exports&&null!=n||(e=r=global),null==e&&(e="undefined"==typeof window?global:window),null==r&&(r=n||e),e.$L=t(e,r),"undefined"!=typeof module&&(module.exports=global.$L)}(this,function(n){"use strict";function t(n,t,e){var r=t.exec(n);return r&&r[e]?r[e]:null}function e(){}function r(){return console.warn('<localizer> In node env. please call $L.fromReq(req)("someKey")'),j(L[0])}var i=Array.prototype.slice,l=!("undefined"==typeof window||!window.document),a=!l,o=n.include||n.atma&&n.atma.include,u=n.mask||n.atma&&n.atma.mask,s=n.Class||n.atma&&n.atma.Class;if(null==o&&a){var f=require("atma-libs/exports");o=f.include,u=f.mask,s=f.Class}var c=a?require("atma-formatter"):window.Formatter||u&&u.$utils.format;if(null==c)throw Error("atma-formatter is not preloaded.");var d,v,h;!function(){d=function(n,t){for(var e=t.split("."),r=e.length,i=-1;++i<r;){if(null==n)return null;n=n[e[i]]}return n},v=function(n,t,e){for(var r,i=t.split("."),l=i.length,a=-1;++a<l-1;)r=i[a],null==n[r]&&(n[r]={}),n=n[r];n[i[a]]=e},h=function(n,t){if(null==n&&(n={}),null==t)return n;var e,r;for(r in t)e=t[r],null!=e&&(n[r]=e);return n}}();var p;!function(){p=function(){var n=i.call(arguments);n.unshift("<i18n>"),console.log.apply(console,n)}}();var g,m;!function(){function e(n){return t(n,/language=(\w+)/,1)}g=function(){var r=e(n.location.search);return null==r&&(r=t(n.navigator.language,/^(\w+)/,1)),r=r.toLowerCase(),w(r)?r:L[0]},m=function(n){var t,r,i=n.url.indexOf("?");if(-1!==i){var l=n.url.substring(n.url);if(t=e(l),w(t))return t}if(r=n.headers["accept-language"],!r)return L[0];r=r.replace(/\s*/g,"").toLowerCase();for(var a,o,u=r.split(","),s=u.length,f=-1;++f<s;)if(o=u[f],a=o.indexOf(";"),t=-1===a?o:o.substring(0,a),w(t))return t;return L[0]}}();var y,w,_,x={},L=["en"];!function(n){w=function(n){return-1!==L.indexOf(n)},y=function(t,e){return null!=e?null==n[t]?void(n[t]=e):void h(n[t],e):void 0},_=function(n){var t=o&&o.route&&o.route.params;if(null!=t){t.support&&(L=t.support.split(","));var e=t.path;return e?l?void b.loadSingle({path:e}).done(n):void b.loadAll({path:e}).done(n):void(n&&n())}}}(x),function(){function n(n,t,e,r){return null==r?n:(null!=t?r.apply(n,t):e.push(r),n)}function t(n){n._done=null,n._fail=null,n._always=null}function r(n,t,e){if(null!=n){for(var r,i=n.length,l=-1;++l<i;)r=n[l],r&&r.apply(t,e);n.length=0}}function i(n,t){return function(){return n.apply(t,arguments)}}e.prototype={_isAsync:!0,_done:null,_fail:null,_always:null,_resolved:null,_rejected:null,defer:function(){this._rejected=null,this._resolved=null},resolve:function(){var n=this._done,e=this._always;return this._resolved=arguments,t(this),r(n,this,arguments),r(e,this,[this]),this},reject:function(){var n=this._fail,e=this._always;return this._rejected=arguments,t(this),r(n,this,arguments),r(e,this,[this]),this},resolveDelegate:function(){return i(this.resolve,this)},rejectDelegate:function(){return i(this.reject,this)},then:function(n,t){return this.done(n).fail(t)},done:function(t){return n(this,this._resolved,this._done||(this._done=[]),t)},fail:function(t){return n(this,this._rejected,this._fail||(this._fail=[]),t)},always:function(t){return n(this,this._rejected||this._resolved,this._always||(this._always=[]),t)}}}();var b;!function(){var t={};!function(){function n(n,t){if(null==o&&l)return void e(n,function(n){t(n)});var r=a?o.instance():o;r.ajax(n+"::Data").done(function(n){t(n.ajax.Data)})}function e(n,t){var e=new XMLHttpRequest;e.onload=function(){var n;try{n=JSON.parse(e.responseText)}catch(r){p("Should be json",r)}finally{t(n)}},e.open("get",n,!0),e.send()}t.file={single:function(t,e,r){n(e,function(n){y(t,n),r()})},many:function(n,t,e){function r(){--i<0&&e()}for(var i=t.length,l=i,a=-1;++a<l;)this.single(t[a],n.replace("%%",t[a]),r)}}}(),t.directory=function(t,e){var r=n.io||n.atma&&f.io,i=r&&r.glob;if(null==i){try{r=require("atma-io")}catch(l){throw p("run `npm i atma-io -save`"),l}i=r.glob}var a=[];i.readFiles(t).forEach(function(n){var t=n.uri.getName(),e=n.read();if("string"==typeof e)try{e=JSON.parse(e)}catch(r){return void p("Failed to load translations",n.uri.toLocalFile())}y(t,e)}),0===a.length&&p("No translations",t),e()};var r={};b={loadAll:function(n){function t(){--r<0&&a.resolve()}n.support&&(L=n.support);for(var r=L.length,i=r,l=-1;++l<i;)n.lang=L[l],this.loadSingle(n).done(t);var a=new e;return a},loadSingle:function(n,i){n.support&&(L=n.support);var l=n.lang,o=n.path;if(null==l&&(l=a?m(i):g()),o){if(o.indexOf("%%")&&(o=o.replace("%%",l)),r[o])return r[o];var u=r[o]=new e;return t.file.single(l,o,u.resolveDelegate()),u}p("<Single Load: implemented `config.path` only>")}}}();var j;!function(n){function t(t){var e=n[t];null==e&&console.error("<localization> Translation is not defined for",t);var r=function(n){var t,r=null==e?n:e[n];return null==r&&(console.warn("<localization> No translation for",n),r=n),1===arguments.length?r:(t=i.call(arguments),t[0]=r,c.apply(null,t))};return r.lang=t,r.extend=y,r}j=function(n){return null==e[n]?e[n]=t(n):e[n]};var e={}}(x);var S;!function(){S=function(){return n.apply(null,arguments)};var n=function(){return n=j(g()),n.apply(null,arguments)}}(),r.fromReq=function(n){if(void 0!==n.$L)return n.$L;var t=m(n),e=j(t);return n.$L=e};var q=a?r:S;if(null!=u){var O,$;!function(){function n(n,e){return n.apply(null,t(e))}function t(n){var t=n[0].trim(),r=n[1],i=n[2],l=n[4];switch(t.charCodeAt(0)){case 40:case 34:case 39:return e(t,r,i,l)}var a=t.indexOf(",");return-1===a?[t]:(n=e(t.substring(a+1),r,i,l),n.unshift(t.substring(0,a)),n)}O=function(t,e,r){return n(q.fromReq(r.req),arguments)},$=function(){return n(q,arguments)};var e=u.Utils.Expression.evalStatements}(),u.registerUtil("L",a?O:$)}return q.loadSingle=b.loadSingle,a&&(q.middleware=function(n){return function(t,e,r){q.loadSingle(n,t).done(function(){q.fromReq(t),r()})}}),_(),q});
//# sourceMappingURL=localization.min.js.map